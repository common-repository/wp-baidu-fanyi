!function(s){"use strict";if(!(s.wbui||0)){var t,e,n,i,o,f=document,p="getElementsByClassName",b=function(t){return f.querySelectorAll(t)},c="OK",l="Cancel",m=["dialog","toast","loading","iframe"],a={type:0,mask:!0,maskClose:!0,closebtn:!0,whenBtnClickClose:!0,fixed:!0,anim:"def"},r={extend:function(t,e){var n="object"==typeof e?JSON.parse(JSON.stringify(e)):JSON.parse(JSON.stringify(a));for(var i in t)n[i]=t[i];return n},timer:{},end:{},touch:function(t,e){t.addEventListener("click",function(t){e.call(this,t)},!1)}},v=0,w=["wbui"],u=function(t){this.config=r.extend(t),this.view()};u.prototype.view=function(){var t=this,n=t.config,e=f.createElement("div"),i="object"==typeof n.content,o="string"==typeof n.type?n.type:w[0]+"-"+m[n.type||0];t.id=e.id=w[0]+v,e.setAttribute("class",w[0]+" "+o),e.setAttribute("index",v);var a,s,c=(a="object"==typeof n.title,n.title?'<h3 class="wbui-title'+(a?" "+n.title[1]:"")+'">'+(a?n.title[0]:n.title)+"</h3>":""),l=(s="object"==typeof n.closebtn,n.closebtn?'<a class="wbui-close'+(s?" "+n.closetype[1]:"")+'"><i></i></a>':""),r=function(){"string"==typeof n.btn&&(n.btn=[n.btn]);var t,e=(n.btn||[]).length;return 0!==e&&n.btn?(t='<span yes type="1">'+n.btn[0]+"</span>",2===e&&(t='<span no type="0">'+n.btn[1]+"</span>"+t),'<div class="wbui-btn">'+t+"</div>"):""}();if(n.fixed||(n.top=n.hasOwnProperty("top")?n.top:100,n.style=n.style||"",n.style+=" top:"+(f.body.scrollTop+n.top)+"px"),2===n.type&&(n.content='<i></i><i class="wbui-load"></i><i></i><p>'+(n.content||"")+"</p>"),3===n.type){n.content=i?n.content:[n.content||"","auto"];n.content='<iframe scrolling="'+(n.content[1]||"auto")+'" allowtransparency="true" id="'+m[3]+v+'" name="'+m[3]+v+'" onload="this.className=\'\';" class="wbui-load" frameborder="0" src="'+n.content[0]+'"></iframe>'}if(n.skin&&(n.anim="fade"),"msg"===n.skin&&(n.mask=n.closebtn=!1,n.time=2),e.innerHTML=(n.mask?"<div "+("string"==typeof n.mask?'style="'+n.mask+'"':"")+' class="wbui-mask"></div>':"")+'<div class="wbui-main" '+(n.fixed?"":'style="position:static;"')+'><div class="wbui-section"><div class="wbui-child '+(n.skin?"wbui-"+n.skin+" ":"")+(n.className?n.className:"")+" "+(n.anim?"wbui-anim-"+n.anim:"")+'" '+(n.style?'style="'+n.style+'"':"")+">"+c+'<div class="wbui-cont">'+n.content+"</div>"+r+(n.closebtn?l:"")+"</div></div></div>",!n.type||2===n.type){var u=f[p](w[0]+m[n.type]);1<=u.length&&wbui.close(u[0].getAttribute("index"))}document.body.appendChild(e);var d=t.elem=b("#"+t.id)[0];n.success&&n.success(d),t.index=v++,t.action(n,d)},u.prototype.action=function(t,e){var n=this;t.time&&(r.timer[n.index]=setTimeout(function(){wbui.close(n.index)},1e3*t.time));function i(){0==this.getAttribute("type")?(t.no&&t.no(),wbui.close(n.index)):(t.yes&&t.yes(n.index),t.whenBtnClickClose&&wbui.close(n.index))}if(t.btn)for(var o=e[p]("wbui-btn")[0].children,a=o.length,s=0;s<a;s++)r.touch(o[s],i);if(t.mask&&t.maskClose){var c=e[p]("wbui-mask")[0];r.touch(c,function(){wbui.close(n.index,t.end)})}if(t.closebtn){var l=e[p]("wbui-close")[0];r.touch(l,function(){wbui.close(n.index,t.end)})}t.end&&(r.end[n.index]=t.end)},s.wbui={v:"1.0.5",index:v,open:function(t){return new u(t||{}).index},alert:function(t,e){var n="function"==typeof e,i=r.extend({content:t,btn:c});return i=n?r.extend({yes:e},i):r.extend(e,i),s.wbui.open(i)},confirm:function(t,e,n,i){var o="function"==typeof e,a=r.extend({content:t,btn:[c,l]});return a=o?r.extend({yes:e,no:n},a):r.extend(e,a),s.wbui.open(a)},toast:function(t,e){var n="function"==typeof e,i=r.extend({type:1,content:t,mask:0,closebtn:0,time:2});return i=n?r.extend({end:e},i):r.extend(e,i),s.wbui.open(i)},loading:function(t){var e="function"==typeof t,n=r.extend({type:2,content:0,mask:0,maskClose:0,closebtn:0});return n=e?r.extend({end:t},n):r.extend(t,n),s.wbui.open(n)},iframe:function(t,e,n,i){var o="function"==typeof e,a=r.extend({type:3,content:t,mask:0});return a=o?r.extend({yes:e,no:n},a):r.extend(e,a),s.wbui.open(a)},close:function(t){var e=b("#"+w[0]+t)[0];e&&(e.innerHTML="",f.body.removeChild(e),clearTimeout(r.timer[t]),delete r.timer[t],"function"==typeof r.end[t]&&r.end[t](),delete r.end[t])},closeAll:function(){for(var t=f[p](w[0]),e=0,n=t.length;e<n;e++)wbui.close(0|t[0].getAttribute("index"))}},"function"==typeof define?define(function(){return wbui}):(e=document.scripts,n=e[e.length-1],i=n.src,o=i.substring(0,i.lastIndexOf("/")+1),n.getAttribute("assets")&&document.head.appendChild(((t=f.createElement("link")).href=o+"assets/wbui.css",t.type="text/css",t.rel="styleSheet",t.id="wbui_css",t)))}}(window),jQuery(document).ready(function(d){var a=JSON.parse(localStorage.getItem("WB_BFY_OPTION"))||{lan:["auto","zh"],title:0,content:1,keep:0,lastObj:0},s={init:function(){var t=s;t.dropdownInteraction("#J_selectTraTo",1),t.dropdownInteraction("#J_selectOriginalLan",0),d("#J_WBBFY_setting .wb-switch").each(function(t,e){1==a[d(e).attr("name")]?d(e).attr("checked","checked"):d(e).remove("checked")}),d("#J_WBBFY_setting .wb-switch").on("change",function(){var t=d(this),e=t.attr("name");a[e]=t.prop("checked")?1:0,a.title||a.content?s.updateOpt(a):wbui.toast("请至少激活一个待翻译的位置")}),a.lastObj&&d(".language-often").append("<li>"+a.lastObj+"</li>")},dropdownInteraction:function(n,i){var t=d(n).find(".wb-selected-btn"),o=d(n).find(".wb-selected-val");t.on("click",function(){d(n).toggleClass("active")}),d(n).on("click",".data-lang",function(){var t=d(this),e=t.attr("value");d(n).find(".data-lang").removeClass("lang-selected"),t.addClass("lang-selected"),o.text(t.text()),o.attr("data-val",e),d(n).removeClass("active"),a.lan[i]=e,s.updateOpt(a),s.setLastTimeUsedItem(t,e)})},updateOpt:function(t){var e=t||a;localStorage.setItem("WB_BFY_OPTION",JSON.stringify(e))},setLastTimeUsedItem:function(t,e){if("en"!=e&&"zh"!=e){t.removeClass("lang-selected");var n=t.parent("li").html();a.lastObj=d.trim(n),s.updateOpt(a)}}};s.init(),d("#wb-bdfanyi-btn").on("click",function(){return d("#wb-bdf-pop").toggle(),d("#wb-bdf-pop").toggleClass("active"),!1}),d("#wb-bdf-pop .wbppo-ft").on("click",function(){d(this).addClass("active")}),d(document).on("click",function(t){var e=d(t.target);d("#wb-bdf-pop .wbppo-ft").hasClass("active")&&!e.closest("#wb-bdf-pop .wbppo-ft").length&&d("#wb-bdf-pop .wbppo-ft").removeClass("active"),d("#wb-bdf-pop").hasClass("active")&&!e.closest("#wb-bdf-pop").length&&d("#wb-bdf-pop").hide().removeClass("active"),d("#J_selectTraTo").hasClass("active")&&!e.closest("#J_selectTraTo").length&&d("#J_selectTraTo").removeClass("active"),d("#J_selectOriginalLan").hasClass("active")&&!e.closest("#J_selectOriginalLan").length&&d("#J_selectOriginalLan").removeClass("active")}),d("#wb-bdf-pop .btn-primary").on("click",function(){var a=JSON.parse(localStorage.getItem("WB_BFY_OPTION"))||{lan:["auto","zh"],title:0,content:1,keep:0,lastObj:0};if(a.lan[0]!=a.lan[1])if(a.title||a.content){var s=wbui.loading({type:2,className:"wbui-bfy-loading",content:"",mask:1,maskClose:0,closebtn:0}),c=setTimeout(function(){var t=wbui.confirm("翻译像是遇到了困难，是否继续等待处理？",{btn:["取消","继续"],yes:function(){wbui.close(t)},no:function(){wbui.close(s)}});clearTimeout(c)},3e5);if(a.title&&d("#title").length){var e=d("#title").val();if(""==e)return void wbui.toast("标题内容为空");var t=setTimeout(function(){clearTimeout(t),d.post(ajaxurl,{action:"wp_baidu_fanyi",do:"fanyi",from:a.lan[0],to:a.lan[1],txt:e},function(t){t.error_code?wbui.alert("翻译异常:"+t.error_msg):(result=t.trans_result[0],a.keep?d("#title").val(e+" "+result.dst):d("#title").val(result.dst))},"json")},1300)}if(a.content&&d("#content").length){var l=!!tinyMCE&&tinyMCE.activeEditor,r=d("#content").val(),n="";if(n=r.replace(/(<([^>]+)>)/gi,""),/^\s+$/g.test(n))return void wbui.toast("内容为空");var u=[];n=(r=r.replace(/<img[^>]+>/gi,function(t){return u.push(t),"✱"})).replace(/<(\/?[a-z0-9]+)[^>]*>/gi,"<$1>"),d.post(ajaxurl,{action:"wp_baidu_fanyi",do:"fanyi",from:a.lan[0],to:a.lan[1],txt:n},function(t){if(wbui.close(s),clearTimeout(c),t.error_code)wbui.alert("翻译出错:"+t.error_msg);else{for(var e=t.trans_result,n=[],i=0;i<e.length;i++)n.push(e[i].dst);var o=n.join("\n");o=o.replace(/✱/gi,function(t){return u.shift()}),a.keep?d("#content").val(r+"\n"+o):d("#content").val(o),l&&(l.setContent(""),l.load()),wbui.toast("翻译内容完成")}},"json")}d("#wb-bdf-pop").hide().removeClass("active")}else wbui.alert("请至少激活一个待翻译的位置");else wbui.alert("翻译目标语言与源语言一样, 请重新选择")})});